<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ëã±Ë™û„Åß„Åä„Åó„ÇÉ„Åπ„Çä„Ç≤„Éº„É†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');
        
        body {
            font-family: 'Nunito', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        }
        .animate-bounce {
            animation: bounce 1s infinite;
        }
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translate3d(0,0,0);
            }
            40%, 43% {
                transform: translate3d(0,-30px,0);
            }
            70% {
                transform: translate3d(0,-15px,0);
            }
            90% {
                transform: translate3d(0,-4px,0);
            }
        }
        .hover-scale {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .hover-scale:hover {
            transform: scale(1.05) translateY(-2px);
        }
        .glass-effect {
            backdrop-filter: blur(16px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .gradient-shadow {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(255, 255, 255, 0.1);
        }
        .pulse-glow {
            animation: pulse-glow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse-glow {
            0%, 100% {
                opacity: 1;
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            }
            50% {
                opacity: 0.8;
                box-shadow: 0 0 30px rgba(59, 130, 246, 0.8);
            }
        }
        .btn-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .btn-gradient:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }
        .game-background {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // „Ç≤„Éº„É†Áä∂ÊÖãÁÆ°ÁêÜ
        let gameState = {
            currentScene: 'menu',
            score: 0,
            currentQuestion: 0,
            selectedCategory: null,
            isListening: false,
            feedback: '',
            showAnswer: false
        };

        // „Ç´„ÉÜ„Ç¥„É™„Éº„Éá„Éº„Çø
        const categories = {
            animals: {
                name: 'ÂãïÁâ©„Åü„Å°',
                emoji: 'üêæ',
                color: 'bg-gradient-to-br from-green-400 to-green-600',
                questions: [
                    {
                        question: "What sound does a cat make?",
                        japanese: "Áå´„ÅØ„Å©„Çì„Å™È≥¥„ÅçÂ£∞Ôºü",
                        answer: "meow",
                        alternatives: ["mew", "meow meow"],
                        image: "üê±"
                    },
                    {
                        question: "What sound does a dog make?",
                        japanese: "Áä¨„ÅØ„Å©„Çì„Å™È≥¥„ÅçÂ£∞Ôºü",
                        answer: "woof",
                        alternatives: ["bow wow", "woof woof", "bark"],
                        image: "üê∂"
                    },
                    {
                        question: "What color is an elephant?",
                        japanese: "Ë±°„ÅØ‰ΩïËâ≤Ôºü",
                        answer: "gray",
                        alternatives: ["grey"],
                        image: "üêò"
                    },
                    {
                        question: "Where do birds live?",
                        japanese: "È≥•„ÅØ„Å©„Åì„Å´‰Ωè„Çì„Åß„ÅÑ„ÇãÔºü",
                        answer: "tree",
                        alternatives: ["trees", "nest", "sky"],
                        image: "üê¶"
                    }
                ]
            },
            food: {
                name: 'È£ü„Åπ„ÇÇ„ÅÆ',
                emoji: 'üçé',
                color: 'bg-gradient-to-br from-red-400 to-red-600',
                questions: [
                    {
                        question: "What color is an apple?",
                        japanese: "„Çä„Çì„Åî„ÅØ‰ΩïËâ≤Ôºü",
                        answer: "red",
                        alternatives: ["green", "yellow"],
                        image: "üçé"
                    },
                    {
                        question: "What do you drink when you're thirsty?",
                        japanese: "„ÅÆ„Å©„ÅåÊ∏á„ÅÑ„Åü„Çâ‰Ωï„ÇíÈ£≤„ÇÄÔºü",
                        answer: "water",
                        alternatives: ["juice", "milk"],
                        image: "üíß"
                    },
                    {
                        question: "What do bees make?",
                        japanese: "„Éè„ÉÅ„ÅØ‰Ωï„Çí‰Ωú„ÇãÔºü",
                        answer: "honey",
                        alternatives: [],
                        image: "üçØ"
                    },
                    {
                        question: "What's yellow and long?",
                        japanese: "ÈªÑËâ≤„Åè„Å¶Èï∑„ÅÑ„ÇÇ„ÅÆ„ÅØÔºü",
                        answer: "banana",
                        alternatives: [],
                        image: "üçå"
                    }
                ]
            },
            colors: {
                name: 'Ëâ≤',
                emoji: 'üåà',
                color: 'bg-gradient-to-br from-purple-400 to-purple-600',
                questions: [
                    {
                        question: "What color is the sun?",
                        japanese: "Â§™ÈôΩ„ÅØ‰ΩïËâ≤Ôºü",
                        answer: "yellow",
                        alternatives: ["orange"],
                        image: "‚òÄÔ∏è"
                    },
                    {
                        question: "What color is grass?",
                        japanese: "Ëçâ„ÅØ‰ΩïËâ≤Ôºü",
                        answer: "green",
                        alternatives: [],
                        image: "üå±"
                    },
                    {
                        question: "What color is the sky?",
                        japanese: "Á©∫„ÅØ‰ΩïËâ≤Ôºü",
                        answer: "blue",
                        alternatives: [],
                        image: "‚òÅÔ∏è"
                    },
                    {
                        question: "What color is snow?",
                        japanese: "Èõ™„ÅØ‰ΩïËâ≤Ôºü",
                        answer: "white",
                        alternatives: [],
                        image: "‚ùÑÔ∏è"
                    }
                ]
            }
        };

        // Èü≥Â£∞Èñ¢ÈÄ£Èñ¢Êï∞
        function playSound(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        function startListening() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                updateState({
                    feedback: '„Åî„ÇÅ„Çì„Å≠ÔºÅ„Åì„ÅÆ„Éñ„É©„Ç¶„Ç∂„ÅØÈü≥Â£∞Ë™çË≠ò„Å´ÂØæÂøú„Åó„Å¶„ÅÑ„Å™„ÅÑ„Çà„ÄÇ„Åß„ÇÇÁ≠î„Åà„ÇíË¶ã„Çã„Åì„Å®„ÅØ„Åß„Åç„Çã„ÇàÔºÅ'
                });
                render();
                return;
            }

            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            
            recognition.lang = 'en-US';
            recognition.continuous = false;
            recognition.interimResults = false;

            updateState({
                isListening: true,
                feedback: 'Ëã±Ë™û„ÅßÁ≠î„Åà„Å¶„Å≠ÔºÅËÅû„ÅÑ„Å¶„ÅÑ„Çã„Çà...'
            });
            render();

            recognition.onresult = (event) => {
                const userAnswer = event.results[0][0].transcript.toLowerCase().trim();
                checkAnswer(userAnswer);
            };

            recognition.onerror = () => {
                updateState({
                    isListening: false,
                    feedback: '„ÅÜ„Åæ„ÅèËÅû„Åì„Åà„Å™„Åã„Å£„Åü„Çà„ÄÇ„ÇÇ„ÅÜ‰∏ÄÂ∫¶Ë©¶„Åó„Å¶„Åø„Å¶ÔºÅ'
                });
                render();
            };

            recognition.onend = () => {
                updateState({ isListening: false });
                render();
            };

            recognition.start();
        }

        function checkAnswer(userAnswer) {
            const currentQ = categories[gameState.selectedCategory].questions[gameState.currentQuestion];
            const correctAnswers = [currentQ.answer, ...currentQ.alternatives];
            
            const isCorrect = correctAnswers.some(answer => 
                userAnswer.includes(answer.toLowerCase()) || answer.toLowerCase().includes(userAnswer)
            );

            if (isCorrect) {
                updateState({
                    score: gameState.score + 10,
                    feedback: `„Åô„Åî„ÅÑÔºÅÊ≠£Ëß£„Å†„ÇàÔºÅ "${userAnswer}" „Å£„Å¶Ë®Ä„Åà„Åü„Å≠ÔºÅ‚≠ê`
                });
                playSound("Great job!");
                render();
                setTimeout(() => {
                    nextQuestion();
                }, 2000);
            } else {
                updateState({
                    feedback: `ÊÉú„Åó„ÅÑÔºÅ„ÇÇ„ÅÜ‰∏ÄÂ∫¶ÊåëÊà¶„Åó„Å¶„Åø„Çà„ÅÜ„ÄÇÊ≠£Ëß£„ÅØ "${currentQ.answer}" „Å†„Çà„ÄÇ`
                });
                playSound(currentQ.answer);
                render();
            }
        }

        function nextQuestion() {
            if (gameState.currentQuestion < categories[gameState.selectedCategory].questions.length - 1) {
                updateState({
                    currentQuestion: gameState.currentQuestion + 1,
                    feedback: '',
                    showAnswer: false
                });
            } else {
                updateState({ currentScene: 'result' });
            }
            render();
        }

        function resetGame() {
            updateState({
                currentScene: 'menu',
                score: 0,
                currentQuestion: 0,
                selectedCategory: null,
                feedback: '',
                showAnswer: false
            });
            render();
        }

        function selectCategory(category) {
            updateState({
                selectedCategory: category,
                currentScene: 'game',
                currentQuestion: 0,
                score: 0,
                feedback: '',
                showAnswer: false
            });
            render();
        }

        function updateState(newState) {
            gameState = { ...gameState, ...newState };
        }

        // „É¨„É≥„ÉÄ„É™„É≥„Ç∞Èñ¢Êï∞
        function renderMenu() {
            return `
                <div class="min-h-screen bg-gradient-to-br from-blue-400 via-purple-500 to-pink-500 p-4">
                    <div class="max-w-4xl mx-auto">
                        <div class="text-center mb-12">
                            <h1 class="text-6xl font-extrabold text-white mb-6 animate-bounce">
                                üé§ Ëã±Ë™û„Åß„Åä„Åó„ÇÉ„Åπ„Çä„Ç≤„Éº„É† üé§
                            </h1>
                            <p class="text-2xl text-white opacity-90 font-semibold">
                                Ëã±Ë™û„ÅßÁ≠î„Åà„Å¶„ÄÅ„Çπ„Çø„Éº„ÇíÈõÜ„ÇÅ„Çà„ÅÜÔºÅ‚ú®
                            </p>
                        </div>
                        
                        <div class="grid md:grid-cols-3 gap-8 mb-12">
                            ${Object.entries(categories).map(([key, category]) => `
                                <button
                                    onclick="selectCategory('${key}')"
                                    class="${category.color} hover-scale transition-all duration-300 rounded-2xl p-8 text-white font-bold text-xl gradient-shadow border-2 border-white border-opacity-20"
                                >
                                    <div class="text-5xl mb-4">${category.emoji}</div>
                                    <div class="text-2xl mb-2">${category.name}</div>
                                    <div class="text-sm opacity-80 font-medium">
                                        ${category.questions.length}Âïè„Å´„ÉÅ„É£„É¨„É≥„Ç∏ÔºÅ
                                    </div>
                                </button>
                            `).join('')}
                        </div>

                        <div class="text-center text-white glass-effect rounded-2xl p-6 max-w-2xl mx-auto gradient-shadow">
                            <p class="text-xl mb-3 font-semibold">üéØ ÈÅä„Å≥Êñπ</p>
                            <p class="text-base opacity-90 leading-relaxed">
                                „Ç´„ÉÜ„Ç¥„É™„Éº„ÇíÈÅ∏„Çì„Åß„ÄÅËã±Ë™û„ÅßË≥™Âïè„Å´Á≠î„Åà„Çà„ÅÜÔºÅ<br/>
                                „Éû„Ç§„ÇØ„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶Ë©±„Åô„Åã„ÄÅÁ≠î„Åà„ÇíË¶ã„Çã„Åì„Å®„ÇÇ„Åß„Åç„Çã„Çà„ÄÇ<br/>
                                Ê≠£Ëß£„Åô„Çã„Å®„Çπ„Çø„Éº‚≠ê„Åå„ÇÇ„Çâ„Åà„Çã„ÇàÔºÅ
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderGame() {
            const currentQ = categories[gameState.selectedCategory].questions[gameState.currentQuestion];
            
            return `
                <div class="min-h-screen bg-gradient-to-br from-blue-400 via-purple-500 to-pink-500 p-4">
                    <div class="max-w-2xl mx-auto">
                        <!-- „Éò„ÉÉ„ÉÄ„Éº -->
                        <div class="flex justify-between items-center mb-6">
                            <button
                                onclick="resetGame()"
                                class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded-lg flex items-center gap-2"
                            >
                                ‚Ü©Ô∏è „É°„Éã„É•„Éº„Å´Êàª„Çã
                            </button>
                            <div class="flex items-center gap-4 text-white">
                                <div class="flex items-center gap-1">
                                    <span class="text-yellow-300">‚≠ê</span>
                                    <span class="font-bold">${gameState.score}</span>
                                </div>
                                <div class="text-sm">
                                    ${gameState.currentQuestion + 1} / ${categories[gameState.selectedCategory].questions.length}
                                </div>
                            </div>
                        </div>

                        <!-- Ë≥™Âïè„Ç´„Éº„Éâ -->
                        <div class="bg-white rounded-3xl p-8 gradient-shadow mb-8">
                            <div class="text-center mb-8">
                                <div class="text-8xl mb-6 transform hover:scale-110 transition-transform duration-300">${currentQ.image}</div>
                                <h2 class="text-3xl font-bold text-gray-800 mb-4">
                                    ${currentQ.question}
                                </h2>
                                <p class="text-xl text-gray-600 font-medium">
                                    ${currentQ.japanese}
                                </p>
                            </div>

                            <!-- Èü≥Â£∞Ë™≠„Åø‰∏ä„Åí„Éú„Çø„É≥ -->
                            <div class="text-center mb-8">
                                <button
                                    onclick="playSound('${currentQ.question.replace(/'/g, "\\'")}')"
                                    class="btn-gradient hover-scale text-white px-8 py-4 rounded-xl font-bold text-lg gradient-shadow flex items-center gap-3 mx-auto"
                                >
                                    üîä Ë≥™Âïè„ÇíËÅû„Åè
                                </button>
                            </div>

                            <!-- ÂõûÁ≠î„Éú„Çø„É≥ -->
                            <div class="flex justify-center gap-6 mb-8 flex-wrap">
                                <button
                                    onclick="startListening()"
                                    ${gameState.isListening ? 'disabled' : ''}
                                    class="${gameState.isListening ? 'bg-red-500 pulse-glow' : 'bg-green-500 hover:bg-green-600'} text-white px-8 py-4 rounded-xl font-bold text-lg hover-scale gradient-shadow flex items-center gap-3"
                                >
                                    üé§ ${gameState.isListening ? 'ËÅû„ÅÑ„Å¶„ÅÑ„Çã„Çà...' : 'Ëã±Ë™û„ÅßÁ≠î„Åà„Çã'}
                                </button>
                                
                                <button
                                    onclick="updateState({showAnswer: !gameState.showAnswer}); render();"
                                    class="bg-orange-500 hover:bg-orange-600 text-white px-8 py-4 rounded-xl font-bold text-lg hover-scale gradient-shadow"
                                >
                                    ${gameState.showAnswer ? 'Á≠î„Åà„ÇíÈö†„Åô' : 'Á≠î„Åà„ÇíË¶ã„Çã'}
                                </button>
                            </div>

                            <!-- Á≠î„ÅàË°®Á§∫ -->
                            ${gameState.showAnswer ? `
                                <div class="text-center bg-gradient-to-r from-yellow-100 to-yellow-200 p-6 rounded-2xl mb-6 border-2 border-yellow-300 gradient-shadow">
                                    <p class="text-xl font-bold text-gray-800 mb-3">
                                        Á≠î„Åà: <span class="text-blue-600 text-2xl">${currentQ.answer}</span>
                                    </p>
                                    ${currentQ.alternatives.length > 0 ? `
                                        <p class="text-base text-gray-600 mb-4">
                                            ‰ªñ„ÅÆÁ≠î„Åà: <span class="font-semibold">${currentQ.alternatives.join(', ')}</span>
                                        </p>
                                    ` : ''}
                                    <button
                                        onclick="playSound('${currentQ.answer.replace(/'/g, "\\'")}')"
                                        class="btn-gradient hover-scale text-white px-6 py-3 rounded-xl font-semibold gradient-shadow flex items-center gap-2 mx-auto"
                                    >
                                        üîä Áô∫Èü≥„ÇíËÅû„Åè
                                    </button>
                                </div>
                            ` : ''}

                            <!-- „Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ -->
                            ${gameState.feedback ? `
                                <div class="text-center bg-gradient-to-r from-blue-100 to-blue-200 p-6 rounded-2xl mb-6 border-2 border-blue-300 gradient-shadow">
                                    <p class="text-gray-800 font-semibold text-lg">${gameState.feedback}</p>
                                </div>
                            ` : ''}

                            <!-- Ê¨°„ÅÆÂïèÈ°å„Éú„Çø„É≥ -->
                            ${gameState.showAnswer ? `
                                <div class="text-center">
                                    <button
                                        onclick="nextQuestion()"
                                        class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white px-10 py-4 rounded-xl font-bold text-xl hover-scale gradient-shadow"
                                    >
                                        Ê¨°„ÅÆÂïèÈ°å„Å∏ ‚Üí
                                    </button>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderResult() {
            const totalQuestions = categories[gameState.selectedCategory].questions.length;
            const maxScore = totalQuestions * 10;
            const percentage = (gameState.score / maxScore) * 100;
            
            return `
                <div class="min-h-screen bg-gradient-to-br from-blue-400 via-purple-500 to-pink-500 p-4 flex items-center justify-center">
                    <div class="bg-white rounded-xl p-8 shadow-xl text-center max-w-md">
                        <div class="text-yellow-500 text-6xl mb-4">üèÜ</div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-4">
                            „Åä„Å§„Åã„Çå„Åï„ÅæÔºÅ
                        </h2>
                        <div class="text-6xl mb-4">
                            ${percentage >= 80 ? 'üèÜ' : percentage >= 60 ? 'ü•à' : 'üèÖ'}
                        </div>
                        <p class="text-xl text-gray-700 mb-4">
                            „Çπ„Ç≥„Ç¢: <span class="font-bold text-blue-600">${gameState.score}</span> / ${maxScore}
                        </p>
                        <p class="text-gray-600 mb-6">
                            ${percentage >= 80 ? '„Åô„Å∞„Çâ„Åó„ÅÑÔºÅ' : 
                              percentage >= 60 ? '„Çà„Åè„Åß„Åç„Åæ„Åó„ÅüÔºÅ' : 
                              '„Åå„Çì„Å∞„Å£„Åü„Å≠ÔºÅ„ÇÇ„ÅÜ‰∏ÄÂ∫¶ÊåëÊà¶„Åó„Å¶„Åø„Çà„ÅÜÔºÅ'}
                        </p>
                        <div class="flex gap-4 justify-center">
                            <button
                                onclick="updateState({currentQuestion: 0, score: 0, currentScene: 'game', feedback: '', showAnswer: false}); render();"
                                class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg"
                            >
                                „ÇÇ„ÅÜ‰∏ÄÂ∫¶
                            </button>
                            <button
                                onclick="resetGame()"
                                class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg"
                            >
                                „É°„Éã„É•„Éº„Å´Êàª„Çã
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function render() {
            const app = document.getElementById('app');
            
            if (gameState.currentScene === 'menu') {
                app.innerHTML = renderMenu();
            } else if (gameState.currentScene === 'game') {
                app.innerHTML = renderGame();
            } else if (gameState.currentScene === 'result') {
                app.innerHTML = renderResult();
            }
        }

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            render();
        });
        
        // Á¢∫ÂÆü„Å™ÂàùÊúüÂåñ
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', render);
        } else {
            render();
        }
    </script>
</body>
</html>
